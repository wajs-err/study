https://codeforces.com/group/PVbQ8eK2T4/contest/357142/problem/B

B. Splay-дерево
ограничение по времени на тест 3 секунды
ограничение по памяти на тест 256 мегабайт
ввод стандартный ввод
вывод стандартный вывод

Реализуйте splay-дерево, которое поддерживает множество S

целых чисел, в котором разрешается производить следующие операции:

    add(i) — добавить в множество S число i (если он там уже есть, то множество не меняется);
    sum(l,r) — вывести сумму всех элементов x из S, которые удовлетворяют неравенству l<=x<=r. 

Решения, не использующие splay-деревья, будут игнорироваться.

Решения, не использующие операции split и merge, будут оцениваться в 2 балла. Решения, использующие операции split и merge, оцениваются в 3 балла.

Входные данные
Исходно множество S пусто. Первая строка входного файла содержит n — количество операций (1≤n≤300000). Следующие n строк содержат операции. Каждая операция имеет вид либо «+ i», либо «? l r». Операция «? l r» задает запрос sum(l,r).

Если операция «+ i» идет во входном файле в начале или после другой операции «+», то она задает операцию add(i). Если же она идет после запроса «?», и результат этого запроса был y, то выполняется операция add((i+y)mod109).

Во всех запросах и операциях добавления параметры лежат в интервале от 0 до 109.

Выходные данные
Для каждого запроса выведите одно число — ответ на запрос.

Пример
Входные данные
6
+ 1
+ 3
+ 3
? 2 4
+ 1
? 2 4
Выходные данные
3
7
