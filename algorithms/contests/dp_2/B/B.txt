https://codeforces.com/group/PVbQ8eK2T4/contest/371629/problem/B

B. Трехкарточный Монти (3 балла, с код-ревью)
ограничение по времени на тест 1 s
ограничение по памяти на тест 256 MB
ввод standard input
вывод standard output

Крис Юрьевич Каменев на вокзале решил сыграть в "Трехкарточный Монти", хотя его мать запретила ему это делать. В этой игре участвуют три карты, выставленные в ряд слева направо. Изначально карта с валетом, которую нужно угадать, находится под стоящей посередине чашкой.

Затем, за один ход карточный мошенник меняет местами карту посередине с одной из двух других карт случайным образом (он выберет каждую с одинаковой вероятностью), так что выбранная карта становится посередине. Игра длится n ходов, и в каждом из них мошенник независимо выбирает карту для обмена со средней на каждом ходу.

После n-го хода мошенник просит Криса указать на карту с валетом, и он указывает на стоящую посередине карту, но Крис отвлекся во время игры и не уверен, находится ли там карта или нет. Поэтому он просит вас сообщить ему вероятность того, что карта с валетом действительно посередине.

Число ходов n может быть очень большим, поэтому Крис не сообщил вам его. Вместо этого он дал вам массив a1,a2,...,ak, такой, что
\[
    n = \prod_{i = 1}^k a_i,
\]
другими словами, n равно произведению чисел данного массива.

Из-за проблем с точностью Крис просит вас сообщить ответ в виде несократимой дроби. Другими словами, найдите ответ в виде p/q, причем gcd(p,q)=1, где gcd — наибольший общий делитель. Так как p и q могут быть очень большими, достаточно вывести остаток от деления каждого из них на 109+7.

Заметьте, что мы хотим, чтобы наибольший общий делитель p и q был равен 1, а не наибольший общий делитель их остатков от деления на 109+7.

Входные данные
В первой строке содержится единственное целое число k (1<=k<=105) — количество элементов в массиве, данном Крисом.
Во второй строке содержатся k целых чисел a1,a2,…,ak (1<=ai<=1018) — элементы массива.

Выходные данные
В единственной строке выведите строку вида x/y, где x — остаток от деления p на 109+7, а y — остаток от деления q на 109+7.

Примеры
Входные данные
1
2
Выходные данные
1/2

Входные данные
3
1 1 1
Выходные данные
0/1
