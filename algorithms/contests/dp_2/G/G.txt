https://codeforces.com/group/PVbQ8eK2T4/contest/371629/problem/G

G. Голод (4 балла, с код-ревью)
ограничение по времени на тест 1 секунда
ограничение по памяти на тест 512 мегабайт
ввод стандартный ввод
вывод стандартный вывод

До конца света осталось не так много дней, но Третий всадник Апокалипсиса Голод так и не смог понять, какие города стоит наказывать за прегрешения, а какие нет. Тогда он решил потренироваться на одной небольшой стране.

Эта страна представляет собой клетчатый прямоугольник размера n×m, в котором каждая клетка — отдельный город. Голод может либо наслать голод на город, либо пощадить его. При этом есть города, в которых еды хватит и до следующего конца света, и Голод не в силах заставить их голодать, а есть те, в которых еды никогда и не было, и им в любом случае придется голодать.

Страшный Суд Голода должен быть ещё и справедлив, а это значит, что в любом квадрате размера 2×2 должно быть поровну голодающих и сытых городов. Теперь Голод хочет узнать количество различных вариантов распределения городов этой страны на голодающие и сытые.

Входные данные
В первой строке входного файла задано два целых числа n и m (1<=n<=15 и 1<=m<=100) — размер страны. Далее следует n строк по m символов в каждой, где символ '+' означает, что соответствующий город не может голодать, символ '—' — соответствующий город будет голодать в любом случае и символ '.' — Голод может решить, что ему делать с этим городом.

Выходные данные
Выведите количество различных вариантов наслать голод на эту страну по модулю 109+7

Пример
Входные данные
3 2
+.
..
.-

Выходные данные
2
