# Команды

## `--help`

У многих команд есть дополнительные опции. Перечислить опции конкретной команды можно с помощью флага `--help`:

```bash
# Подставьте вместо `cmake` интересующую вас команду
$ clippy cmake --help
```

## Autocompletion

Поддерживается простое автодополнение для основных команд (перечислены в [`commands.txt`](/commands.txt)).

---

| Команда | Описание  |
| --- | --- |
| `hi`   | Привет! |
| `help` | Печатает список всех команд |

## Уровень репозитория

Эти команды можно запускать в любом месте репозитория:

| Команда | Описание  |
| --- | --- |
| `update` | Обновляет репозиторий курса и сабмодули. В рамках `update` также вызывается команда `cmake` |
| `cmake` | Генерирует файлы сборки (`--clean` – со сбросом кэша). Следует выполнять после обновления репозитория и после добавления новых файлов к решению задачи |
| `warmup` | Собирает общие библиотеки (цели перечислены в `warmup_targets` конфига `clippy`) |
| `status`, `st` | Печатает информацию о текущем рабочем окружении и текущей задаче |

## Уровень задачи

Эти команды нужно вызывать из директории с задачей (в том числе из любой поддиректории):

| Команда | Описание  |
| --- | --- |
| `test` | Собирает и запускает тесты задачи |
| `target` | Собирает и запускает конкретную цель задачи |
| `gdb` | Собирает конкретную цель задачи и запускает на ней [GDB](https://www.gnu.org/software/gdb/) |

### Команда `test`

```shell
# Запускаем тесты, описанные в task.json задачи
clippy test

# По умолчанию команда `test` выполняет команду `censor` перед запуском тестов
# Шаг `censor` можно отключить с помощью флага --no-censor
clippy test --no-censor

# С помощью опции --config можно передать конфиг с собственным пайплайном тестирования:
# В нем должна быть секция `tests` в том же формате, что и в task.json
clippy test --config {path}
```

### Команда `target`

```shell
# Запускаем цель `tests` в сборке `Debug`
clippy target tests Debug 

# Запускаем цель и передаем ей дополнительные аргументы:
# -- разделяет аргументы clippy и аргументы запускаемой цели
clippy target tests Debug -- --arg1 1 --arg2 2
```

### Команда `gdb`

```shell
# Запускаем отладку цели `tests` в сборке `Debug`
clippy gdb tests Debug

# Запускаем отладку цели и передаем ей дополнительные аргументы:
# -- разделяет аргументы clippy и аргументы запускаемой цели
clippy gdb tests Debug -- --arg1 1 --arg2 2
```

### Линтеры

| Команда | Описание                                                                                                                                                                  |
| --- |---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `format` | Форматирует код решения задачи с помощью [`clang-format`](https://clang.llvm.org/docs/ClangFormat.html). Используется конфиг `.clang-format` из корня репозитория         |
| `tidy` | Применяет [`clang-tidy`](https://clang.llvm.org/extra/clang-tidy/) к решению задачи. Используется конфиг `.clang-tidy` из корня репозитория                               |
| `lint` | `tidy` + `format`    
| `censor` | Проверяет решение на наличие запрещенных паттернов (см. секцию `forbidden` в конфиге задачи и в корневом конфиге `.clippy.json`) |
| `validate` | Запускает линтеры в режиме проверки + `censor` |

## Решения

| Команда | Описание  |
| --- | --- |
| `attach` | Клонирует remote репозиторий решений локально в соседнюю с репозиторием курса директорию, связывает репозиторий курса с репозиторием решений (для команд `commit`, `push` и т.д.) |
| `attach-local` | Привязывает к репозиторию задач уже существующий локальный репозиторий решений |
| `solutions` | Печатает локальный путь / remote привязанного репозитория с решениями |
| `commit`, `ci` | Коммитит файлы теущей задачи (см. `submit_files` в `task.json`) в ветку локального репозитория с решениями |
| `push` | Пушит коммиты из ветки текущей задачи локального репозитория решений в remote-репозиторий решений | 
| `merge-request` | Создает для текущей задачи MR из ветки решения в `master` со всеми запушенными коммитами |
| `apply` | Перенести код решения из ветки локального репозитория решений в директорию с задачей |

### Команда `apply`

```shell
# С помощью опции `--commit` можно перенести в репозиторий задач конкретную версию решения
clippy apply --commit {sha}
```
